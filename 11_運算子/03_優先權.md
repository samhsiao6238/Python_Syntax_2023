# 運算子優先權

<br>

## 1. 簡介

- 非常重要也容易被忽略的一部分，特別是除了基礎數學 `加減乘除` 以外的部分。
- 運算子優先權決定了邏輯程序中哪些程式區塊必須先計算。

</br>

## 2. 運算子優先權

_由 `最高 1` 排序到 `最低 13`_


| 優先級 | 運算子                                       | 描述                       |
| ------ | -------------------------------------------- | -------------------------- |
| 1      | `()`                                       | 括號                       |
| 2      | `**`                                       | 指數運算                   |
| 3      | `~`                                        | 位元反轉                   |
| 4      | `*`, `/`, `//`, `%`                  | 乘法、除法、取整數、取餘數 |
| 5      | `+`, `-`                                 | 加法、減法                 |
| 6      | `<<`, `>>`                               | 位元左移、位元右移         |
| 7      | `&`                                        | 位元 AND                   |
| 8      | `^`                                        | 位元 XOR                   |
| 9      | `\|`                                        | 位元 OR                    |
| 10     | `==`, `!=`, `<`, `<=`, `>`, `>=` | 比較運算子                 |
| 11     | `not`                                      | 邏輯 NOT                   |
| 12     | `and`                                      | 邏輯 AND                   |
| 13     | `or`                                       | 邏輯 OR                    |
| 14     | `=`                                        | 賦值運算子，其中一個代表   |

_Python 不支持混合多個賦值運算子在運算式中，所以不存在複合賦值運算子的優先權問題_

</br>

## 3. 實作觀察

### 3.1 括號

- *最高階優先權*

  ```python
  result = (2 + 3) * 4 
  print(result)
  ```

  _RESULT_
  ```bash
  20
  ```

</br>

### 3.2 指數

- `**` 指數運算優先權僅次於括號。

  *先計算 4 的平方，然後再進行乘法*

  ```python
  result = 2 * 4 ** 2  
  print(result) 
  ```

  _RESULT_

  ```bash
  32
  ```

</br>

### 3.3 位元反轉

- 波浪符號 `~` 是位元反轉運算子。
- 特別注意 `位元反轉運算子` 與 `位元運算子` 優先順序不同。
- `位元反轉 (bitwise NOT)` 也是一種 `位元運算`，適用於 `整數` ，對於給定的數字，以 `二進位` 形式對每個位元進行翻轉：將 1 變成 0，將 0 變成 1。

  *先進行位元反轉，然後再加 1*

  ```python
  result = ~4 + 1 # -5 + 1  
  print(result)  
  ```

  _RESULT_

  ```bash
  -4
  ```

</br>

### 3.4 加減乘、取商、除餘數運算子

- 取商、取餘數運算子優先權同除法運算子

  _同一般數學，省略_

</br>

### 3.5 位元運算子

- 包括 `<<`、`>>`、`&`、`^`、`|`。

1. 基本的位元 AND 運算：

   ```python
   result = 5 & 3  
   print(result)
   ```

   _RESULT_

   ```bash
   1
   ```

   *說明一下二進位位元計算*

   ```markdown
     101  (這是 5 的二進位)
   & 011  (這是 3 的二進位)
   ------
     001  (結果結果)
   ```
2. 位元左移運算與加法：

   - 首先進行加法: 5 + 3 = 8，然後左移2位: 8 << 2 = 32

   ```python
   result = 5 + 3 << 2
   print(result)  
   ```

   _RESULT_

   ```bash
   32
   ```
3. 位元OR運算與乘法：

   - 首先進行乘法: 5 * 3 = 15，然後OR運算: 15 | 2 = 15

   ```python
   result = 5 * 3 | 2
   print(result)  
   ```

   _RESULT_

   ```bash
   15
   ```
4. 位元XOR運算與除法：

   - 首先進行除法: 16 / 4 = 4，然後XOR運算: 4 ^ 2 = 6

   ```python
   result = 16 / 4 ^ 2
   print(result)  
   ```

   _RESULT_

   ```bash
   6
   ```
5. 位元右移運算與指數：

   - 首先進行指數運算: 2 ** 3 = 8，然後右移2位: 8 >> 2 = 2

   ```python
   result = 2 ** 3 >> 2
   print(result)  
   ```

   _RESULT_

   ```bash
   2
   ```

</br>

### 3.6 比較運算子

  *包括 `==`、`!=`、`<`、`<=`、`>`、`>=`。*

- 判斷是否相等

  ```python
  is_equal = 5 == 3  
  print(is_equal)
  ```

  *RESULT*
  ```bash
  False
  ```

</br>

- 先進行加法和乘法，然後比較

  ```python
  is_greater = 5 + 3 > 2 * 4  
  print(is_greater)
  ```

  *RESULT*
  ```bash
  False
  ```

</br>

- 先進行除法和減法，然後比較

  ```python
  is_less_equal = 10 / 2 <= 7 - 2  
  print(is_less_equal)
  ```

  *RESULT*
  ```bash
  True
  ```

</br>

### 3.7 邏輯運算子

- 包括 `not`、`and`、`or`。

  ```python
  result = not (5 == 3)  # 使用邏輯非
  print(result) 
  ```

  *RESULT*

  ```bash
  True
  ```

</br>

## 4. 常見的運算子優先權問題

1. 簡單鏈式比較

- 鏈式運算採用的是兩兩分組的比較，而不是單純的先後比較。

  ```python
  5 > 0 > 0
  ```
  _結果：(5 > 0) and (0 > 0)_
  ```bash
  Fasle
  ```

<br>

2. 複雜的鏈式比較
   
- Python 支持更長的鏈式比較。

  ```python
  5 > 0 > 0 > 0
  ```
  _結果：(5 > 0) and (0 > 0) and (0 > 0)_
  ```bash
  Fasle
  ```  

<br>

3. 包含優先權比較的鏈式比較

- `位元運算子 &` 的優先等級高於 `比較運算子 >` 。
- 下面的範例中，將先進行 `0 & y` 的運算。
- 首先計算 0 & y，即 0 & 5。其二進位表示分別為 0000 和 0101，所以 0 & 5 的結果是 0。
- 接著這個表達式變成 x > 0 > 0，這是一個 `鏈式比較`，在 Python 中這樣的比較會先進行分解為 `(x > 0) and (0 > 0)` 。
- 顯而易見， `True and False` 在 Python 中的運算結果會是 `False`。

  ```python
  x = 10
  y = 5
  _result = x > 0 & y > 0 
  print(_result)  
  ```

  *RESULT*

  ```bash
  False
  ```

---

END
